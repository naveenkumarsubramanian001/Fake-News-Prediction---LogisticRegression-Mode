# -*- coding: utf-8 -*-
"""Fake News Prediction - LogisticRegression Model.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1r0BBQK-2HsV2L_VNme2rKaaTgIlsZEMo
"""

import numpy as np
import pandas as pd
import re
import nltk
from nltk.corpus import stopwords
from nltk.stem.porter import PorterStemmer
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.linear_model import LogisticRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
from sklearn.preprocessing import LabelEncoder
import csv

news_data = pd.read_csv('/content/fake_or_real_news.csv')

news_data.head()

label = LabelEncoder()
news_data['label'] = label.fit_transform(news_data['label'])
news_data.head()

import nltk
nltk.download('stopwords')

print(stopwords.words('english'))

port_stem = PorterStemmer()

def stemming(content):
  stem_content = re.sub('^a-zA-Z',' ',content)
  stem_content = stem_content.lower()
  stem_content = stem_content.split()
  stem_content = [port_stem.stem(word) for word in stem_content if not word in stopwords.words('english')]
  stem_content = ' '.join(stem_content)
  return stem_content

news_data['content'] = news_data['title']+' '+news_data['text']

news_data.head()

X = news_data['content'].apply(stemming)
Y = news_data['label']

print(X,Y)

vector = TfidfVectorizer()

X = vector.fit_transform(X)

X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size = 0.2, stratify=Y)

model = LogisticRegression()

model.fit(X_train, Y_train)

train_pred = model.predict(X_train)
test_pred = model.predict(X_test)
trainaccuracy = accuracy_score(Y_train, train_pred)
test_accuracy = accuracy_score(Y_test, test_pred)
print('Accuracy score of the training data : ', trainaccuracy)
print('Accuracy score of the test data : ', test_accuracy)

X_new = X_test[4]
print(Y_test[4])
prediction = model.predict(X_new)
print(prediction)
if (prediction==1):
  print('The news is Real')
else:
  print('The news is Fake')

